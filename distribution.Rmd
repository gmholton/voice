---
title: "Distribution of Voice Systems"
author: "Gary Holton"
date: "8/29/2019"
output: html_document
---


# Distribution of Austronesian Voice Systems

## LING 770, Fall 2019


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(googlesheets)
library(dplyr)
library(tidyr)
library(RColorBrewer)
library(ggplot2)
library(leaflet)
```

```{r}
glottolog <- read.csv("https://cdstar.shh.mpg.de/bitstreams/EAEA0-E7DE-FA06-8817-0/languages_and_dialects_geo.csv", stringsAsFactors = F)
glotto_geo <- select(glottolog, glottocode, isocodes, latitude, longitude )

gs <- gs_title("Voicemap")
distrib <- gs_read(ss=gs, ws="Voice", na.strings="" )

distrib_geo <- left_join(distrib, glotto_geo)


# set colors
factpal <- colorFactor(brewer.pal(length(unique(distrib_geo$System)), "Set1"), distrib_geo$System )

# then plot circles
leaflet(distrib_geo) %>%
  addTiles() %>%
  addCircleMarkers(lng= ~longitude, lat= ~latitude, color=~factpal(System), radius = 15,
                   stroke = FALSE, fillOpacity = 0.5, label=~System) %>%
    setView(lng=115, lat=0, zoom = 4) %>%
    addLegend(values = ~System,  pal = factpal, title="Distribution of voice systems" )


```
